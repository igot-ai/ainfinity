name: finetune


resources:
  infra: vast
  cpus: 16+
  memory: 64+
  accelerators: RTX4090:1  # or your desired GPU type
  disk_size: 100  # GB
  image_id: docker:nvidia/cuda:12.1.1-devel-ubuntu20.04


workdir: .

setup: |
  uv venv .venv --python=3.12
  source .venv/bin/activate

  # Install all dependencies from pyproject.toml
  uv sync --group gpu
  uv pip install flash-attn --no-build-isolation


run: |
  source .venv/bin/activate

  # Launch training
  bash script/finetune/finetune_with_deepspeed.sh
